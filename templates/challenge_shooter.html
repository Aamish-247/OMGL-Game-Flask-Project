{% extends "layout.html" %}
{% block content %}
<style>
    body {
        background-color: #121212;
        color: #f8f9fa;
        font-family: 'Orbitron', sans-serif;
        overflow-x: hidden;
    }

    body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: repeating-linear-gradient(180deg, rgba(255,0,0,0.05) 0, rgba(255,0,0,0.05) 2px, transparent 2px, transparent 4px);
        animation: glitchBg 0.3s infinite;
        pointer-events: none;
        z-index: -1;
    }

    @keyframes glitchBg {
        0% { transform: translate(0, 0); }
        20% { transform: translate(2px, -2px); }
        40% { transform: translate(-2px, 2px); }
        60% { transform: translate(1px, -1px); }
        80% { transform: translate(-1px, 1px); }
        100% { transform: translate(0, 0); }
    }

    h3 {
        font-size: 2.2rem;
        text-shadow: 0 0 10px red;
        animation: pulse 2s infinite alternate;
        margin-bottom: 1rem;
    }

    .form-control {
        background-color: hsl(0, 0%, 12%);
        color: #b8b4b4; 
        border: 1px solid red;
    }

    .form-control:focus {
        background-color: #1e1e1e;
        border-color: #ff0000;
        box-shadow: 0 0 10px red;
        color: #b8b4b4;
    }
    .form-control::placeholder {
        color: #b8b4b4; 
        opacity: 1; 
    }
    .form-control:focus::placeholder {
        color: #ff0000; 
        opacity: 1; 
    }

    .btn-danger {
        background-color: #d00000;
        border-color: #ff0000;
        box-shadow: 0 0 15px red;
        transition: transform 0.3s ease-in-out;
        position: relative;
        top: -35px;
    }

    .btn-danger:hover {
        background-color: #ff0000;
        color: black;
        transform: scale(1.05);
    }
    select option[value=""] {
    color: gray; /* Change text color */
    opacity: 0.5; /* Reduce opacity */
    }
    #timer {
        font-size: 1.5rem;
        font-weight: bold;
        color: #ff0000;
        text-shadow: 0 0 10px red;
        margin-left: 53vw;
        margin-top: 2px;
    }

    @keyframes pulse {
        from { text-shadow: 0 0 10px red; }
        to { text-shadow: 0 0 30px #ff1a1a; }
    }
</style>
<div class="container mt-5">
    <h3>Sharp Shooter Challenge</h3>
    <p style="white-space: pre-wrap; word-wrap: break-word;">{{ challenge.question | safe }}</p>

    <form method="POST">
        <!-- Dynamically Render Inputs -->
        {% if challenge.type == "quiz" %}
    <!-- Quiz Challenge: Show 4 Radio Button Options -->
            {% for option in challenge.options %}
                <div class="form-check" style="display: block; margin-bottom: 10px;">
                    <input 
                        class="form-check-input" 
                        type="radio" 
                        name="answer" 
                        value="{{ option }}" 
                        id="option-{{ loop.index }}" 
                        style="margin-right: 10px;" 
                        required
                    >
                    <label class="form-check-label" for="option-{{ loop.index }}">
                        {{ option }}
                    </label>
                </div>
            {% endfor %}
        {% elif challenge.type == "debug" %}
            <!-- Debug Challenge: Show Text Box and Dropdown -->
            <input 
                type="text" 
                name="answer" 
                class="form-control mb-3" 
                placeholder="Enter your response..." 
                required
            >
            <select name="error_type" class="form-control">
                <option value="" disabled selected>Select error type</option>
                <option value="syntax">Syntax Error</option>
                <option value="runtime">Runtime Error</option>
                <option value="logical">Logical Error</option>
            </select>
        {% else %}
            <!-- General Challenges: Single Input Box -->
            <input 
                type="text" 
                name="answer" 
                class="form-control" 
                placeholder="Enter your response..." 
                required
            >
        {% endif %}

        <!-- Timer Display -->
        <p id="timer" class="text-danger font-weight-bold mt-3">20 seconds remaining</p>

        <!-- Submit Button -->
        <button class="btn btn-danger mt-4" type="submit">ðŸŽ¯ Submit</button>
    </form>
</div>

<script>
   // Timer Logic
let timeLeft = 20; // Timer duration in seconds
const timerDisplay = document.getElementById('timer');


// Countdown Timer
const countdown = setInterval(() => {
    if (timeLeft <= 0) {
        clearInterval(countdown);
        alert("â° Time's up! Returning to the maze...");
        window.location.href = "/maze"; // Redirect to maze
    } else {
        timerDisplay.innerText = `${timeLeft} seconds remaining`;
        timeLeft--;
    }
}, 1000);

// Clear the timer if the form is submitted
const form = document.querySelector('form');
form.addEventListener('submit', () => {
    clearInterval(countdown); // Stop the timer
});
</script>
{% endblock %}